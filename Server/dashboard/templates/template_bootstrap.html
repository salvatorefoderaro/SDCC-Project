<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Jekyll v4.0.1">
    <title>Home - SDCC Project</title>


    <!-- Bootstrap core CSS -->
<link href="{{ url_for('static', filename='css/bootstrap.css') }}" rel="stylesheet">

  <style>
      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
      }

      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }

      .scrolling-wrapper{
	overflow-x: auto;
}

.card-block{
	height: 250px;
	background-color: #fff;
	border: none;
	transition: all 0.2s ease-in-out !important;
	&:hover{
		transform: translateY(-5px);
		box-shadow: none;
	}
}

.icon-atmosphere {
    background-image: url("{{ url_for('static', filename='img/atmosphere.png') }}");
    background-position: center center;
    width: 100px;
    height: 100px;
}

.icon-clear {
  background-image: url("{{ url_for('static', filename='img/clear.png') }}");
    background-position: center center;
    width: 100px;
    height: 100px;
}

.icon-clouds {
  background-image: url("{{ url_for('static', filename='img/clouds.png') }}");
    background-position: center center;
    width: 100px;
    height: 100px;
}

.icon-drizzle {
  background-image: url("{{ url_for('static', filename='img/drizzle.png') }}");
    background-position: center center;
    width: 100px;
    height: 100px;
}

.icon-rain {
  background-image: url("{{ url_for('static', filename='img/rain.png') }}");
    background-position: center center;
    width: 100px;
    height: 100px;
}

.icon-snow {
  background-image: url("{{ url_for('static', filename='img/snow.png') }}");
    background-position: center center;
    width: 100px;
    height: 100px;
}

.icon-thunderstorm {
  background-image: url("{{ url_for('static', filename='img/thunderstorm.png') }}");
    background-position: center center;
    width: 100px;
    height: 100px;
}
    </style>
    <!-- Custom styles for this template -->
    <link href="{{ url_for('static', filename='css/starter-template.css') }}" rel="stylesheet">
  </head>
  <body>
    <nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top">

  <div class="collapse navbar-collapse" id="navbarsExampleDefault">
    <ul class="navbar-nav mr-auto">
      <li class="nav-item active">
        <a class="nav-link" href="/">Home <span class="sr-only">(current)</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/getFileList">Archivio dump</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/getGroupsList">Gestione gruppi</a>
      </li>
    </ul>
   </div>
</nav>

<main role="main" class="container">

  {% if response == true %}
  <div class="alert alert-success" role="alert">
    Modifica effettuata con successo!
  </div>
    {% elif response == false %}
    <div class="alert alert-warning" role="alert">
    Modifica non effettuata!
    </div>
      {% endif %}

      <h2><a href="/checkDevicesStatus">Controlla manualmente lo stato dei dispositivi</a></h2>

      <div class="container-fluid">
        <div class="scrolling-wrapper row flex-row flex-nowrap mt-4 pb-4">
          
          {% for i in range(0, weather['weather_forecasts']|length ) %} 
          {% set id = i|string %}
          {% set weather_collapse = "weather_collapse" ~ id %}
          {% set weather_collapse_link = "#weather_collapse" ~ id %}


          <div class="col-5">
            <div class="card weather-card">
      
              <!-- Card content -->
              <div class="card-body pb-3">
            
                <!-- Title -->
                <!-- <h4 class="card-title font-weight-bold">Warsaw</h4> -->
                <!-- Text -->
                <p class="card-text">{{  weather['weather_forecasts'][i]['day'] }}</p>
                <div class="d-flex justify-content-between">
                  <p class="display-1 degree">{{ weather['weather_forecasts'][i]['temperatures']['morning'] |int }}&deg;</p>
                 <!-- <p class="display-1 degree">23</p> -->
                  {% if 'atmosphere' in weather['weather_forecasts'][i]['description'] %}
                  <i class="icon-atmosphere"></i>    
                  {% elif 'clear' in weather['weather_forecasts'][i]['description'] %}
                  <i class="icon-clear"></i>    
                  {% elif 'clouds' in weather['weather_forecasts'][i]['description'] %}
                  <i class="icon-clouds"></i>   
                  {% elif 'drizzle' in weather['weather_forecasts'][i]['description'] %}
                  <i class="icon-drizzle"></i>    
                  {% elif 'rain' in weather['weather_forecasts'][i]['description'] %}
                  <i class="icon-rain"></i>    
                  {% elif 'snow' in weather['weather_forecasts'][i]['description'] %}
                  <i class="icon-snow"></i>    
                  {% elif 'thunderstorm' in weather['weather_forecasts'][i]['description'] %}
                  <i class="icon-thunderstorm"></i>
                  {% endif %}                </div>
                <div class="d-flex justify-content-between mb-4"><p>
                  {{  weather['weather_forecasts'][i]['prob_of_precipitations'] }}&percnt; Precipitazioni</p>
                  <p>{{  weather['weather_forecasts'][i]['wind_speed'] }} km/h Venti</p>
                </div>
            
                <div class="collapse-content">
            
                  <div class="collapse" id="{{ weather_collapse }}">
            
                    <table class="table table-borderless table-sm mb-0">
                      <tbody>
                        <tr>
                          <td class="font-weight-normal align-middle">Mattina</td>
                          <td class="float-right font-weight-normal">
                            <p class="mb-1">{{  weather['weather_forecasts'][i]['temperatures']['morning'] }}&deg;</p>
                          </td>
                          <td class="float-right mr-3">
                            <i class="fas fa-sun fa-lg amber-text"></i>
                          </td>
                        </tr>
                        <tr>
                          <td class="font-weight-normal align-middle">Giorno</td>
                          <td class="float-right font-weight-normal">
                            <p class="mb-1">{{  weather['weather_forecasts'][i]['temperatures']['daylight'] }}&deg;</p>
                          </td>
                          <td class="float-right mr-3">
                            <i class="fas fa-cloud-sun-rain fa-lg text-info"></i>
                          </td>
                        </tr>
                        <tr>
                          <td class="font-weight-normal align-middle">Sera</td>
                          <td class="float-right font-weight-normal">
                            <p class="mb-1">{{  weather['weather_forecasts'][i]['temperatures']['evening'] }}&deg;</p>
                          </td>
                          <td class="float-right mr-3">
                            <i class="fas fa-sun fa-lg amber-text"></i>
                          </td>
                        </tr>
                        <tr>
                          <td class="font-weight-normal align-middle">Notte</td>
                          <td class="float-right font-weight-normal">
                            <p class="mb-1">{{  weather['weather_forecasts'][i]['temperatures']['night'] }}&deg;</p>
                          </td>
                          <td class="float-right mr-3">
                            <i class="fas fa-sun fa-lg amber-text"></i>
                          </td>
                        </tr>
                      </tbody>
                    </table>
            
                  </div>
            
                  <hr class="">
            
                    <a class="btn btn-flat red-text p-1 my-1 mr-0 mml-1 deep-purple-text collapsed" data-toggle="collapse" href="{{ weather_collapse_link }}" aria-expanded="false" aria-controls="collapseExample">Mostra dettaglio</a>
            
                </div>
            
              </div>
            
            </div>    
          </div>
          {%endfor%} 

          
          </div>
          
        </div>

  {% for i in range(0, myString['list']|length ) %} 

  <p><h2>Group name is: {{ myString['list'][i]['groupName'] }}</h2>
{% if ndvi[myString['list'][i]['groupName']] is defined%}

<div class="card weather-card w-40">

  <!-- Card content -->
  <div class="card-body pb-3">

    <!-- Title -->
    <h4 class="card-title font-weight-bold">Qualit√† vegetazion1e</h4>
    <!-- Text -->
    <div class="d-flex justify-content-between">
      <p class="display-1 degree">{{ ndvi[myString['list'][i]['groupName']] }}</p>
      <i class="icon-car"></i>
    </div>

  </div>

</div>

{% endif %}

  <div>
  {% if myString['list'][i]['devicesList']|length > 0%}
<p>
  <h3>Sensor list</h3>

  <div class="container-fluid">
    <div class="scrolling-wrapper row flex-row flex-nowrap mt-4 pb-4">
  {%for j in range(0, myString['list'][i]['devicesList']|length )%} 
  <div class="col-5">

      <div class="card">

        {% if myString['list'][i]['devicesList'][j]['status'] == 0 %}
          <div class="card-body" style="background-color:green;">
        {% else %}
          <div class="card-body" style="background-color:red;">
        {% endif %}
          <h5 class="card-title">{{ myString['list'][i]['devicesList'][j]['name'] }}</h5>
        </div>
        <ul class="list-group list-group-flush">
          <li class="list-group-item">ID: {{ myString['list'][i]['devicesList'][j]['id'] }}</li>
          <li class="list-group-item">Indirizzo IP: {{ myString['list'][i]['devicesList'][j]['ipAddress'] }} : {{ myString['list'][i]['devicesList'][j]['ipPort']}}</li>
          <!-- <li class="list-group-item">Nome: {{ myString['list'][i]['devicesList'][j]['name'] }}</li> -->
          <!-- <li class="list-group-item">Gruppo: {{ myString['list'][i]['devicesList'][j]['groupName'] }}</li> -->
          <li class="list-group-item">Ultima temperatura: {{ myString['list'][i]['devicesList'][j]['temperatura'] }}</li>
          <li class="list-group-item">Ultima umidit√†: {{ myString['list'][i]['devicesList'][j]['umidita'] }}</li>
          <li class="list-group-item">Ultima rilevazione: {{ myString['list'][i]['devicesList'][j]['lettura'] }}</li>
        </ul>

        {% set name_collapse = "name_collapse" ~ myString['list'][i]['devicesList'][j]['id'] %}
        {% set group_collapse = "group_collapse" ~ myString['list'][i]['devicesList'][j]['id'] %}
        {% set lecture_collapse = "lecture_collapse" ~ myString['list'][i]['devicesList'][j]['id'] %}
        {% set link_name_collapse = "#name_collapse" ~ myString['list'][i]['devicesList'][j]['id'] %}
        {% set link_group_collapse = "#group_collapse" ~ myString['list'][i]['devicesList'][j]['id'] %}
        {% set link_lecture_collapse = "#lecture_collapse" ~ myString['list'][i]['devicesList'][j]['id'] %}
        {% set link_delete = "deleteDevice?id=" ~ myString['list'][i]['devicesList'][j]['id'] %}

        <div class="card-body">
          {% if myString['list'][i]['devicesList'][j]['status'] == 0 %}
          <a data-toggle="collapse" href= {{ link_name_collapse }} role="button" aria-expanded="false" aria-controls="nameCollapse" class="card-link">Modifica nome</a>
          <a data-toggle="collapse" href= {{ link_group_collapse }} role="button" aria-expanded="false" aria-controls="groupCollapse" class="card-link">Modifica gruppo</a>
          <a data-toggle="collapse" href= {{ link_lecture_collapse }} role="button" aria-expanded="false" aria-controls="lectureCollapse" class="card-link">Modifica intervallo lettura</a>
          {% endif %}
          <a href={{ link_delete }} class="card-link">Elimina</a>
        </div>

        <div class="collapse" id={{ name_collapse }}>
          <div class="card card-body">

            <form action="/modifyDevice" method="GET">
              <div class="form-group">
                <label for="exampleInputEmail">Nome</label>
                <input type="text" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="new_value" placeholder="Nome nuovo" required>
                <input type="hidden" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="id" value={{ myString['list'][i]['devicesList'][j]['id'] }}>
                <input type="hidden" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="type" value="name">
                <input type="hidden" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="ip_address" value= {{ myString['list'][i]['devicesList'][j]['ipAddress'] }}>
                <input type="hidden" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="port" value= {{ myString['list'][i]['devicesList'][j]['ipPort'] }}>

                <button type="submit" class="btn btn-primary">Submit</button>
              </div>
            </form>
          </div>
        </div>

        <div class="collapse" id= {{ group_collapse }}>
          <div class="card card-body">

            <form action="/modifyDevice" method="GET">
              <div class="form-group">
                <label for="exampleInputEmail1">Gruppo</label>
                <input type="text" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="new_value" placeholder="Gruppo nuovo" required>
                <input type="hidden" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="id" value={{ myString['list'][i]['devicesList'][j]['id'] }}>
                <input type="hidden" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="type" value="groupName">
                <input type="hidden" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="ip_address" value= {{ myString['list'][i]['devicesList'][j]['ipAddress'] }}>
                <input type="hidden" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="port" value= {{ myString['list'][i]['devicesList'][j]['ipPort'] }}>

                <button type="submit" class="btn btn-primary">Submit</button>
              </div>
            </form>
          </div>
        </div>

        <div class="collapse" id= {{ lecture_collapse }}>
          <div class="card card-body">
            <form action="/modifyDevice" method="GET">
              <div class="form-group">
                <label for="exampleInputEmail1">Intervallo lettura</label>
                <input type="number" min="5" step="1" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="new_value" placeholder="Nuovo intervallo lettura" required>
                <input type="hidden" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="id" value={{ myString['list'][i]['devicesList'][j]['id'] }}>
                <input type="hidden" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="type" value="lecture_interval">
                <input type="hidden" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="ip_address" value= {{ myString['list'][i]['devicesList'][j]['ipAddress'] }}>
                <input type="hidden" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="port" value= {{ myString['list'][i]['devicesList'][j]['ipPort'] }}>

                <button type="submit" class="btn btn-primary">Submit</button>
              </div>
            </form>
          </div>
        </div>

    </div>

  {%endfor%} 
     </div>
  </div>
      </p>
{% endif %}

{% if myString['list'][i]['controlList']|length > 0%}
        <h3>Control list</h3>
        <p>
          <div class="container-fluid">
            <div class="scrolling-wrapper row flex-row flex-nowrap mt-4 pb-4">
          {%for j in range(0, myString['list'][i]['controlList']|length )%} 
          <div class="col-5">
          <div class="card">
            {% if myString['list'][i]['controlList'][j]['status'] == 0 %}
          <div class="card-body" style="background-color:green;">
        {% else %}
          <div class="card-body" style="background-color:red;">
        {% endif %}
              <h5 class="card-title">{{ myString['list'][i]['controlList'][j]['name'] }}</h5>
            </div>

              <ul class="list-group list-group-flush">
              <li class="list-group-item">ID: {{ myString['list'][i]['controlList'][j]['id'] }}</li>
              <li class="list-group-item">Indirizzo IP: {{ myString['list'][i]['controlList'][j]['ipAddress'] }} : {{ myString['list'][i]['controlList'][j]['ipPort']}}</li>
              <li class="list-group-item">Ultima rilevazione: {{ myString['list'][i]['controlList'][j]['lettura'] }}</li>

              <!-- <li class="list-group-item">Nome: {{ myString['list'][i]['controlList'][j]['name'] }}</li> -->
              <!-- <li class="list-group-item">Gruppo: {{ myString['list'][i]['controlList'][j]['groupName'] }}</li> -->
            </ul>
    
            {% set name_collapse = "name_collapse" ~ myString['list'][i]['controlList'][j]['id'] %}
            {% set group_collapse = "group_collapse" ~ myString['list'][i]['controlList'][j]['id'] %}
            {% set lecture_collapse = "lecture_collapse" ~ myString['list'][i]['controlList'][j]['id'] %}
            {% set link_name_collapse = "#name_collapse" ~ myString['list'][i]['controlList'][j]['id'] %}
            {% set link_group_collapse = "#group_collapse" ~ myString['list'][i]['controlList'][j]['id'] %}
            {% set link_lecture_collapse = "#lecture_collapse" ~ myString['list'][i]['controlList'][j]['id'] %}
            {% set link_delete = "deleteDevice?id=" ~ myString['list'][i]['controlList'][j]['id'] %}
    
            <div class="card-body">
              {% if myString['list'][i]['controlList'][j]['status'] == 0 %}
              <a data-toggle="collapse" href= {{ link_name_collapse }} role="button" aria-expanded="false" aria-controls="nameCollapse" class="card-link">Modifica nome</a>
              <a data-toggle="collapse" href= {{ link_group_collapse }} role="button" aria-expanded="false" aria-controls="groupCollapse" class="card-link">Modifica gruppo</a>
              {% endif %}
              <a href={{ link_delete }} class="card-link">Elimina</a>
            </div>
    
            <div class="collapse" id={{ name_collapse }}>
              <div class="card card-body">
    
                <form action="/modifyDevice" method="GET">
                  <div class="form-group">
                    <label for="exampleInputEmail">Nome</label>
                    <input type="text" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="new_value" placeholder="Nome nuovo" required>
                    <input type="hidden" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="id" value={{ myString['list'][i]['controlList'][j]['id'] }}>
                    <input type="hidden" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="type" value="name">
                    <input type="hidden" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="ip_address" value= {{ myString['list'][i]['controlList'][j]['ipAddress'] }}>
                    <input type="hidden" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="port" value= {{ myString['list'][i]['controlList'][j]['ipPort'] }}>
    
                    <button type="submit" class="btn btn-primary">Submit</button>
                  </div>
                </form>
              </div>
            </div>
    
            <div class="collapse" id= {{ group_collapse }}>
              <div class="card card-body">
    
                <form action="/modifyDevice" method="GET">
                  <div class="form-group">
                    <label for="exampleInputEmail1">Gruppo</label>
                    <input type="text" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="new_value" placeholder="Gruppo nuovo" required>
                    <input type="hidden" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="id" value={{ myString['list'][i]['controlList'][j]['id'] }}>
                    <input type="hidden" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="type" value="groupName">
                    <input type="hidden" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="ip_address" value= {{ myString['list'][i]['controlList'][j]['ipAddress'] }}>
                    <input type="hidden" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="port" value= {{ myString['list'][i]['controlList'][j]['ipPort'] }}>
    
                    <button type="submit" class="btn btn-primary">Submit</button>
                  </div>
                </form>
              </div>
            </div>
          </div>
          </div>
          </div>
  
    
              {%endfor%} 
                  </div>
         </div>
        </p>
    {% endif %}        

  {%endfor%} 
            </p>
          </div>


</main><!-- /.container -->
<script src=" {{ url_for('static', filename='js/jquery-3.5.1.slim.min.js') }}"></script><script src="{{ url_for('static', filename='js/bootstrap.bundle.js') }}"></script></body>
</html>
