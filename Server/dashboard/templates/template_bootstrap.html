<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Jekyll v4.0.1">
    <title>Starter Template · Bootstrap</title>

    <link rel="canonical" href="https://getbootstrap.com/docs/4.5/examples/starter-template/">

    <!-- Bootstrap core CSS -->
<link href="{{ url_for('static', filename='css/bootstrap.css') }}" rel="stylesheet">

    <style>
      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
      }

      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }
    </style>
    <!-- Custom styles for this template -->
    <link href="{{ url_for('static', filename='css/starter-template.css') }}" rel="stylesheet">
  </head>
  <body>
    <nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top">

  <div class="collapse navbar-collapse" id="navbarsExampleDefault">
    <ul class="navbar-nav mr-auto">
      <li class="nav-item active">
        <a class="nav-link" href="/">Home <span class="sr-only">(current)</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/getFileList">Archivio dump</a>
      </li>
    </ul>
   </div>
</nav>

<main role="main" class="container">

  {% if response == true %}
  <div class="alert alert-success" role="alert">
    Modifica effettuata con successo!
  </div>
    {% elif response == false %}
    <div class="alert alert-warning" role="alert">
    Modifica non effettuata!
    </div>
      {% endif %}

  {% for i in range(0, myString['list']|length ) %} 

  <h2>Group name is: {{ myString['list'][i]['groupName'] }}</h2>
      
  <div class="card-deck">
      {%for j in range(0, myString['list'][i]['devicesList']|length )%} 

      <div class="card" style="width: 18rem;">

        {% if myString['list'][i]['devicesList'][j]['status'] == 0 %}
          <div class="card-body" style="background-color:green;">
        {% else %}
          <div class="card-body" style="background-color:red;">
        {% endif %}
          <h5 class="card-title">{{ status }} {{ myString['list'][i]['devicesList'][j]['name'] }}</h5>
        </div>
        <ul class="list-group list-group-flush">
          <li class="list-group-item">ID: {{ myString['list'][i]['devicesList'][j]['id'] }}</li>
          <li class="list-group-item">Indirizzo IP: {{ myString['list'][i]['devicesList'][j]['ipAddress'] }} : {{ myString['list'][i]['devicesList'][j]['ipPort']}}</li>
          <!-- <li class="list-group-item">Nome: {{ myString['list'][i]['devicesList'][j]['name'] }}</li> -->
          <!-- <li class="list-group-item">Gruppo: {{ myString['list'][i]['devicesList'][j]['groupName'] }}</li> -->
          <li class="list-group-item">Ultima temperatura: {{ myString['list'][i]['devicesList'][j]['temperatura'] }}</li>
          <li class="list-group-item">Ultima umidità: {{ myString['list'][i]['devicesList'][j]['umidita'] }}</li>
          <li class="list-group-item">Ultima rilevazione: {{ myString['list'][i]['devicesList'][j]['lettura'] }}</li>
        </ul>

        {% set name_collapse = "name_collapse" ~ myString['list'][i]['devicesList'][j]['id'] %}
        {% set group_collapse = "group_collapse" ~ myString['list'][i]['devicesList'][j]['id'] %}
        {% set link_name_collapse = "#name_collapse" ~ myString['list'][i]['devicesList'][j]['id'] %}
        {% set link_group_collapse = "#group_collapse" ~ myString['list'][i]['devicesList'][j]['id'] %}
        {% set link_delete = "deleteDevices?id=" ~ myString['list'][i]['devicesList'][j]['id'] %}

        <div class="card-body">
          {% if myString['list'][i]['devicesList'][j]['status'] == 0 %}
          <a data-toggle="collapse" href= {{ link_name_collapse }} role="button" aria-expanded="false" aria-controls="nameCollapse" class="card-link">Modifica nome</a>
          <a data-toggle="collapse" href= {{ link_group_collapse }} role="button" aria-expanded="false" aria-controls="groupCollapse" class="card-link">Modifica gruppo</a>
          {% endif %}
          <a href={{ link_delete }} class="card-link">Elimina</a>
        </div>

        <div class="collapse" id={{ name_collapse }}>
          <div class="card card-body">

            <form action="/modifyDevice" method="GET">
              <div class="form-group">
                <label for="exampleInputEmail">Nome</label>
                <input type="text" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="new_value" placeholder="Nome nuovo">
                <input type="hidden" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="id" value={{ myString['list'][i]['devicesList'][j]['id'] }}>
                <input type="hidden" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="type" value="name">
                <input type="hidden" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="ip_address" value= {{ myString['list'][i]['devicesList'][j]['ipAddress'] }}>
                <input type="hidden" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="port" value= {{ myString['list'][i]['devicesList'][j]['ipPort'] }}>

                <button type="submit" class="btn btn-primary">Submit</button>
              </div>
            </form>
          </div>
        </div>

        <div class="collapse" id= {{ group_collapse }}>
          <div class="card card-body">

            <form action="/modifyDevice" method="GET">
              <div class="form-group">
                <label for="exampleInputEmail1">Gruppo</label>
                <input type="text" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="new_value" placeholder="Gruppo nuovo">
                <input type="hidden" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="id" value={{ myString['list'][i]['devicesList'][j]['id'] }}>
                <input type="hidden" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="type" value="groupName">
                <input type="hidden" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="ip_address" value= {{ myString['list'][i]['devicesList'][j]['ipAddress'] }}>
                <input type="hidden" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="port" value= {{ myString['list'][i]['devicesList'][j]['ipPort'] }}>

                <button type="submit" class="btn btn-primary">Submit</button>
              </div>
            </form>
          </div>
        </div>

      </div>

      {% if j % 3 == 2%}
      </div>
      <div class="card-deck">
      {% endif%}
      
          {%endfor%} 
        </div>
  </p>

  {%endfor%} 


</main><!-- /.container -->
<script src=" {{ url_for('static', filename='js/jquery-3.5.1.slim.min.js') }}"></script>
      <script>window.jQuery || document.write('<script src="../assets/js/vendor/jquery.slim.min.js"><\/script>')</script><script src="{{ url_for('static', filename='js/bootstrap.bundle.js') }}"></script></body>
</html>
